labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
gghighlight(State == 'CA')
inc %>%
ggplot(aes(x = State, color = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
gghighlight(State == 'CA')
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
gghighlight(State == 'CA')
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
gghighlight(State == 'CA') +
geom_text(stat = 'count', aes(label = ..count..))
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..))+
gghighlight(State == 'CA')
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..)ï¼Œ vjust = -1)+
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = -1)+
gghighlight(State == 'CA')
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = 2)+
gghighlight(State == 'CA')
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = 5)+
gghighlight(State == 'CA')
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5)+
gghighlight(State == 'CA')
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5)+
gghighlight(State == 'CA')
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', vjust = -0.5)+
gghighlight(State == 'CA')
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5)+
gghighlight(State == 'CA')
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5)+
gghighlight(count>300)
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5)+
gghighlight(count(State) > 300)
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5)+
gghighlight()
inc %>% count(State, sort = T)
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5)+
gghighlight()
inc %>% count(State, sort = T)
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5)+
gghighlight(State == 'CA' | State == 'TX' | State == 'NY')
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5)+
gghighlight(..count.. > 300)
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5)+
gghighlight(stat > 300)
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5)+
gghighlight(inc %>% filter(count(State)>300))
?gghighlight
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5)+
gghighlight(count(inc$State) > 300)
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5)+
gghighlight(use_group_by = T)
inc %>% filter(count(State) > 300)
inc %>% summarize(count(State) > 300)
inc %>%
ggplot(aes(x = State, fill = State)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 0.3),
axis.text = element_text(size = 10),
panel.background = element_blank()) +
labs(x = 'states',
y = 'number of companies',
title = 'distribution of companies in states') +
geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5)+
gghighlight(State == 'CA' | State == 'TX' | State == 'NY')
inc %>% filter(State == 'NY')
ny <- inc %>% filter(State == 'NY')
summary(ny)
ny %>%
group_by(Industry) %>%
count(Employees)
ny %>%
group_by(Industry) %>%
sum(Employees)
ny %>%
group_by(Industry) %>%
summarise(total_employee = sum(Employees))
ny[order(ny %>%
group_by(Industry) %>%
summarise(total_employee = sum(Employees))), ]
ny %>%
group_by(Industry) %>%
summarise(total_employee = sum(Employees), sort = T)
ny %>%
group_by(Industry) %>%
summarise(total_employee = sum(Employees)) %>%
order_by(total_employee)
?arrange
ny <- inc %>% filter(State == 'NY')
summary(ny)
ny %>%
group_by(Industry) %>%
summarise(total_employee = sum(Employees)) %>%
arrange(total_employee)
ny %>%
group_by(Industry) %>%
summarise(total_employee = sum(Employees)) %>%
arrange(total_employee, desc)
ny %>%
group_by(Industry) %>%
summarise(total_employee = sum(Employees)) %>%
arrange(total_employee, 'desc')
ny %>%
group_by(Industry) %>%
summarise(total_employee = sum(Employees)) %>%
arrange(total_employee, desc)
ny %>%
group_by(Industry) %>%
summarise(total_employee = sum(Employees)) %>%
arrange(total_employee)
ny %>%
group_by(Industry) %>%
summarise(total_employee = sum(Employees)) %>%
sort(total_employee, decreasing = T)
ny %>%
group_by(Industry) %>%
summarise(total_employee = sum(Employees)) %>%
arrange(desc(total_employee))
res <- ny %>%
group_by(Industry) %>%
summarise(total_employee = sum(Employees)) %>%
arrange(desc(total_employee))
res %>%
ggplot(aes(x = Industry)) +
geom_boxplot()
res %>%
ggplot(aes(x = Industry)) +
geom_boxplot() +
facet_wrap(~ Industry)
res %>%
ggplot(aes(x = Industry, y = total_employee)) +
geom_boxplot() +
facet_wrap(~ Industry)
res %>%
ggplot(aes(x = Industry, y = total_employee)) +
geom_boxplot() +
facet_grid(~Industry)
ny %>%
ggplot(aes(x = Industry, y = Employees)) +
geom_boxplot() +
facet_grid(~Industry)
ny %>%
ggplot(aes(x = Industry, y = Employees)) +
geom_boxplot() +
facet_grid(~Industry) +
facet_wrap(~Industry)
ny %>%
ggplot(aes(x = Industry, y = Employees)) +
geom_boxplot() +
coord_flip()
ny
ny %>% arrange(desc(Employees))
complete.cases(ny)
ny %>%
ggplot(aes(x = Industry, y = Employees)) +
geom_boxplot() +
coord_flip()
# boxplot with extreme outliers
ny %>%
ggplot(aes(x = Industry, y = Employees)) +
geom_boxplot() +
coord_flip() +
lab(title = 'employee distribution over industries(with extreme outliers)')
# boxplot with extreme outliers
ny %>%
ggplot(aes(x = Industry, y = Employees)) +
geom_boxplot() +
coord_flip() +
labs(title = 'employee distribution over industries(with extreme outliers)')
# boxplot with extreme outliers
ny %>%
ggplot(aes(x = Industry, y = Employees)) +
geom_boxplot() +
coord_flip() +
labs(title = 'employee distribution over industries(with extreme outliers)')+
theme_bw()
# boxplot with extreme outliers
ny %>%
ggplot(aes(x = Industry, y = Employees)) +
geom_boxplot() +
coord_flip() +
labs(title = 'employee distribution over industries(with extreme outliers)')+
theme(panel.background = element_blank())
# check extreme outlier cases
ny %>% arrange(desc(Employees))
# filter out these outliers
ny1 <- ny %>%
filter(Employees < 10000) %>%
arrange(desc(Employees))
ny1
# make boxplot again
ny1 %>%
ggplot(aes(x = Industry, y = Employees)) %>%
geom_boxplot()
# make boxplot again
ny1 %>%
ggplot(aes(x = Industry, y = Employees)) +
geom_boxplot()
# make boxplot again
ny1 %>%
ggplot(aes(x = Industry, y = Employees)) +
geom_boxplot() +
coord_flip()
# make boxplot again
ny1 %>%
ggplot(aes(x = Industry, y = Employees, color = Growth_Rate)) +
geom_boxplot() +
coord_flip()
# make boxplot again
ny1 %>%
ggplot(aes(x = Industry, y = Employees, fill = Growth_Rate)) +
geom_boxplot() +
coord_flip()
geom_line(aes(x = Industry, y = Growth_Rate)) +
geom_boxplot() +
# make boxplot again
ny1 %>%
ggplot(aes(x = Industry, y = Employees) +
geom_boxplot() +
geom_line(aes(x = Industry, y = Growth_Rate)) +
coord_flip()
# make boxplot again
ny1 %>%
ggplot(aes(x = Industry, y = Employees))+
geom_boxplot() +
geom_line(aes(x = Industry, y = Growth_Rate)) +
coord_flip()
# make boxplot again
ny1 %>%
ggplot(aes(x = Industry, y = Employees))+
geom_boxplot() +
geom_line(aes(x = Industry, y = mean(Growth_Rate))) +
coord_flip()
# make boxplot again
ny1 %>%
ggplot(aes(x = Industry, y = Employees))+
geom_boxplot() +
coord_flip()
ny1 %>% ggplot(aes(x = Industry, y = Employees)) + geom_density()
ny1 %>% ggplot(aes(x = Industry, y = Employees)) + geom_line()
ny1 %>% IQR(0.9)
ny1 %>% IQR(90)
data("cars")
plot(dist ~ speed, cars, ylab = 'distance', xlab = 'speed')
g <- lm(dist ~ speed, cars)
abline(g)
gel <- lm(dist~ I(speed + rnorm(50)), cars)
abline(gel)
abline(gel, lty = 2)
ge2 <-  lm(dist ~ I(speed + 2 * rnorm(50)), cars)
abline(ge2, lty = 3)
plot(dist ~ speed, cars, ylab = 'distance', xlab = 'speed')
abline(g)
abline(gel, lty = 2)
abline(ge2, lty = 3)
ge5 <- lm(dist~I(speed + 5 * rnorm(50)), cars)
abline(ge5, lty = 5)
vv <- rep(1:5/10, each = 1000)
c(0, 1:5/10) + 0.5
c(0, 1:5/10)
slope <- numeric(5000)
sqrt(0.1)
for (i in 1:5000) {
slope[i] <- lm(dist ~ I(speed + sqrt(vv[i])*rnorm(50)), cars)
}
slope[i] <- lm(dist ~ I(speed + sqrt(vv[i])*rnorm(50)), cars)$coef[2]
for (i in 1:5000) {
slope[i] <- lm(dist ~ I(speed + sqrt(vv[i])*rnorm(50)), cars)$coef[2]
}
beta <- c(coef(g)[2], colMeans(matrix(slope, nrow = 1000)))
matrix(slope, nrow = 1000)
colMeans(matrix(slope, nrow = 1000))
?colMeans
Matrix::colMeans(matrix(slope, nrow = 1000))
typeof(matrix(slope, nrow = 1000))
data("LifeCycleSavings")
data("seatpos")
names(seatpos)
g <- lm(hipcenter ~ . , seatpos)
model.matrix(g)[-1]
model.matrix(g)[,-1]
model.matrix(g)
x <- model.matrix(g)[,-1]
e <- eigen(t(x) %*% x)
e
e$values
e$values[1]
sqrt(e$values[1]/e$values)
matrix(slope[-1, ]
matrix(slope[-1,], nrow=1000)
slope[-1, ]
slope[c(-1), ]
slope
matrix(slope, nrow = 1000)
slope_matrix <- matrix(slope, nrow = 1000)
beta <- c(coef(g)[2], colMeans(slope_matrix))
colMeans(slope_matrix[,1])
slope_matrix[, 1]
colMeans(slope_matrix[[,1]])
slope_matrix <- as.integer(slope_matrix)
slope_matrix <- matrix(slope, nrow = 1000)
colMeans(slope_matrix[1][1])
Matrix::colMeans(slope_matrix)
View(slope_matrix)
colMeans(slope_matrix['V1'])
cbind(x1 = 3, x2 = c(4:1, 2:5))
slope_matrix
typeof(cbind(x1 = 3, x2 = c(4:1, 2:5)))
typeof(slope_matrix)
unlist(slope_matrix)
slope_matrix <- array(unlist(slope_matrix), dim = slope_matrix)
slope_matrix <- array(unlist(slope_matrix), dim = dim(slope_matrix))
slope_matrix <- array(slope, dim = c(5, 1000))
View(slope_matrix)
slope_matrix <- array(slope, dim = c(1000, 5))
View(slope_matrix)
slope_matrix <- array(unlist(slope), dim = c(1000, 5))
beta <- c(coef(g)[2], colMeans(slope_matrix))
